\select@language {english}
\contentsline {chapter}{\numberline {1}Introduction}{17}{chapter.1}
\contentsline {section}{\numberline {1.1}Strict vs.\ Relaxed Consistency}{17}{section.1.1}
\contentsline {section}{\numberline {1.2}Avoiding Coherence Messaging}{18}{section.1.2}
\contentsline {section}{\numberline {1.3}Reducing Side-Channel Leakage}{18}{section.1.3}
\contentsline {section}{\numberline {1.4}Contributions}{19}{section.1.4}
\contentsline {section}{\numberline {1.5}Dissertation Overview}{19}{section.1.5}
\contentsline {chapter}{\numberline {2}Background}{22}{chapter.2}
\contentsline {section}{\numberline {2.1}Software Directed Coherence}{23}{section.2.1}
\contentsline {section}{\numberline {2.2}Directory-Based Coherence}{24}{section.2.2}
\contentsline {section}{\numberline {2.3}Time-Based Coherence}{25}{section.2.3}
\contentsline {subsection}{\numberline {2.3.1}Early Research}{26}{subsection.2.3.1}
\contentsline {subsection}{\numberline {2.3.2}Compiler-based Approach}{26}{subsection.2.3.2}
\contentsline {subsection}{\numberline {2.3.3}Hardware-assisted Approach}{27}{subsection.2.3.3}
\contentsline {subsection}{\numberline {2.3.4}Lamport Clocks}{28}{subsection.2.3.4}
\contentsline {section}{\numberline {2.4}Memory Consistency}{28}{section.2.4}
\contentsline {subsection}{\numberline {2.4.1}Memory Consistency Trace Format}{29}{subsection.2.4.1}
\contentsline {subsection}{\numberline {2.4.2}Defining Memory Consistency}{29}{subsection.2.4.2}
\contentsline {subsubsection}{\numberline {2.4.2.1}Sequential Consistency}{30}{subsubsection.2.4.2.1}
\contentsline {subsubsection}{\numberline {2.4.2.2}Total Store Order}{30}{subsubsection.2.4.2.2}
\contentsline {subsubsection}{\numberline {2.4.2.3}Partial Store Order}{30}{subsubsection.2.4.2.3}
\contentsline {subsubsection}{\numberline {2.4.2.4}Relaxed Memory Order}{31}{subsubsection.2.4.2.4}
\contentsline {section}{\numberline {2.5}Cache Side-Channel Attacks}{33}{section.2.5}
\contentsline {subsection}{\numberline {2.5.1}Cryptography and SCAs}{34}{subsection.2.5.1}
\contentsline {subsection}{\numberline {2.5.2}SCA Mitigation}{35}{subsection.2.5.2}
\contentsline {paragraph}{General Techniques}{36}{Item.3}
\contentsline {paragraph}{AES Specific Techniques}{37}{Item.10}
\contentsline {subsection}{\numberline {2.5.3}SCA Analysis Tools}{37}{subsection.2.5.3}
\contentsline {section}{\numberline {2.6}Summary}{37}{section.2.6}
\contentsline {chapter}{\numberline {3}BERI Multiprocessor Architecture}{39}{chapter.3}
\contentsline {section}{\numberline {3.1}BERI Architecture}{39}{section.3.1}
\contentsline {paragraph}{Pipeline Stages}{39}{section.3.1}
\contentsline {paragraph}{Memory System}{40}{figure.caption.13}
\contentsline {paragraph}{Peripherals}{40}{figure.caption.13}
\contentsline {section}{\numberline {3.2}Bluespec System Verilog}{41}{section.3.2}
\contentsline {section}{\numberline {3.3}Multiprocessor BERI Design}{41}{section.3.3}
\contentsline {subsection}{\numberline {3.3.1}Memory Modification}{42}{subsection.3.3.1}
\contentsline {paragraph}{Directory Coherence}{42}{subsection.3.3.1}
\contentsline {paragraph}{Time-Based Coherence}{42}{figure.caption.14}
\contentsline {subsection}{\numberline {3.3.2}Core Identification}{42}{subsection.3.3.2}
\contentsline {subsection}{\numberline {3.3.3}Interrupt Delivery}{43}{subsection.3.3.3}
\contentsline {subsection}{\numberline {3.3.4}Load Linked and Store Conditional}{44}{subsection.3.3.4}
\contentsline {section}{\numberline {3.4}FPGA Implementation}{45}{section.3.4}
\contentsline {section}{\numberline {3.5}Testing and Debugging}{47}{section.3.5}
\contentsline {subsection}{\numberline {3.5.1}Hardware and Software Tracing}{47}{subsection.3.5.1}
\contentsline {subsection}{\numberline {3.5.2}Cheritest}{47}{subsection.3.5.2}
\contentsline {subsection}{\numberline {3.5.3}Bare Metal Tests}{47}{subsection.3.5.3}
\contentsline {subsection}{\numberline {3.5.4}CHERI Litmus Tests}{48}{subsection.3.5.4}
\contentsline {subsection}{\numberline {3.5.5}Memory Consistency Checker}{48}{subsection.3.5.5}
\contentsline {subsection}{\numberline {3.5.6}Benchmarks on FreeBSD}{48}{subsection.3.5.6}
\contentsline {section}{\numberline {3.6}Summary}{48}{section.3.6}
\contentsline {chapter}{\numberline {4}BERI Coherence Models}{51}{chapter.4}
\contentsline {section}{\numberline {4.1}BERI Time-Based Coherence}{52}{section.4.1}
\contentsline {subsection}{\numberline {4.1.1}Time Counter}{52}{subsection.4.1.1}
\contentsline {subsection}{\numberline {4.1.2}Tag Time Stamp}{53}{subsection.4.1.2}
\contentsline {subsection}{\numberline {4.1.3}Time-out Selection}{53}{subsection.4.1.3}
\contentsline {subsection}{\numberline {4.1.4}TTS Memory Overhead}{54}{subsection.4.1.4}
\contentsline {subsection}{\numberline {4.1.5}SYNC Instruction Behaviour}{55}{subsection.4.1.5}
\contentsline {subsection}{\numberline {4.1.6}Polling Detection Mechanism}{55}{subsection.4.1.6}
\contentsline {subsection}{\numberline {4.1.7}SYNC-Only Coherence}{56}{subsection.4.1.7}
\contentsline {section}{\numberline {4.2}BERI Directory Coherence}{58}{section.4.2}
\contentsline {subsection}{\numberline {4.2.1}Data Cache Structure}{59}{subsection.4.2.1}
\contentsline {subsection}{\numberline {4.2.2}Last Level Cache Structure}{61}{subsection.4.2.2}
\contentsline {section}{\numberline {4.3}Comparative Cache Design}{63}{section.4.3}
\contentsline {paragraph}{Inclusion Policy:}{63}{section.4.3}
\contentsline {paragraph}{Associativity:}{63}{section.4.3}
\contentsline {paragraph}{Line Eviction:}{63}{section.4.3}
\contentsline {paragraph}{Virtual and Physical Addressing:}{64}{section.4.3}
\contentsline {paragraph}{Cache Line Granularity:}{64}{section.4.3}
\contentsline {paragraph}{Line Aliasing:}{64}{section.4.3}
\contentsline {paragraph}{False Sharing:}{65}{section.4.3}
\contentsline {paragraph}{Memory Operation Reordering:}{65}{section.4.3}
\contentsline {paragraph}{Prefetching:}{65}{section.4.3}
\contentsline {paragraph}{Alignment:}{65}{section.4.3}
\contentsline {paragraph}{Cache Instructions:}{65}{section.4.3}
\contentsline {paragraph}{Write Buffers:}{66}{section.4.3}
\contentsline {paragraph}{Write Hit Policy:}{66}{section.4.3}
\contentsline {paragraph}{Write Miss Policy:}{66}{section.4.3}
\contentsline {section}{\numberline {4.4}Coherence Hardware Overhead Comparison}{68}{section.4.4}
\contentsline {paragraph}{Time-Based Coherence}{68}{section.4.4}
\contentsline {paragraph}{Directory Coherence}{68}{section.4.4}
\contentsline {paragraph}{FPGA Area Overheads}{68}{section.4.4}
\contentsline {section}{\numberline {4.5}Application of Time-Based Coherence }{70}{section.4.5}
\contentsline {paragraph}{Simplicity}{70}{section.4.5}
\contentsline {paragraph}{Usability}{70}{section.4.5}
\contentsline {paragraph}{Scalability}{70}{section.4.5}
\contentsline {chapter}{\numberline {5}Memory Consistency Verification}{71}{chapter.5}
\contentsline {section}{\numberline {5.1}BERI Time-Based Coherence}{71}{section.5.1}
\contentsline {subsection}{\numberline {5.1.1}Observable Relaxed Behaviour}{72}{subsection.5.1.1}
\contentsline {paragraph}{AXE Test (MP+sync+dep)}{72}{subsection.5.1.1}
\contentsline {paragraph}{AXE Test (WRC+sync+dep)}{73}{figure.caption.25}
\contentsline {paragraph}{AXE Test (W+RWC+sync+dep+sync)}{74}{figure.caption.26}
\contentsline {subsection}{\numberline {5.1.2}Non-Observable Relaxed Behaviour}{75}{subsection.5.1.2}
\contentsline {paragraph}{AXE Test (LB+sync+dep)}{75}{subsection.5.1.2}
\contentsline {subsection}{\numberline {5.1.3}Forbidden Behaviour}{76}{subsection.5.1.3}
\contentsline {paragraph}{AXE Test (MP+syncs)}{76}{subsection.5.1.3}
\contentsline {subsection}{\numberline {5.1.4}CHERI Litmus Tests}{77}{subsection.5.1.4}
\contentsline {subsection}{\numberline {5.1.5}AXE Trace Evaluation}{80}{subsection.5.1.5}
\contentsline {subsubsection}{\numberline {5.1.5.1}Sequential Consistency Test}{80}{subsubsection.5.1.5.1}
\contentsline {subsubsection}{\numberline {5.1.5.2}Total Store Order Consistency Test}{81}{subsubsection.5.1.5.2}
\contentsline {subsubsection}{\numberline {5.1.5.3}Partial Store Order Consistency Test}{82}{subsubsection.5.1.5.3}
\contentsline {subsection}{\numberline {5.1.6}Regression Testing}{83}{subsection.5.1.6}
\contentsline {section}{\numberline {5.2}BERI Directory Coherence}{84}{section.5.2}
\contentsline {subsection}{\numberline {5.2.1}AXE Trace Evaluation}{84}{subsection.5.2.1}
\contentsline {subsection}{\numberline {5.2.2}Regression Testing}{85}{subsection.5.2.2}
\contentsline {section}{\numberline {5.3}General Performance Evaluation Using Litmus}{86}{section.5.3}
\contentsline {chapter}{\numberline {6}Coherence Results and Evaluation}{89}{chapter.6}
\contentsline {section}{\numberline {6.1}Splash-2 Benchmarks}{89}{section.6.1}
\contentsline {section}{\numberline {6.2}Effects of Time-outs on Performance}{90}{section.6.2}
\contentsline {section}{\numberline {6.3}Optimising Time-Based Coherence}{96}{section.6.3}
\contentsline {section}{\numberline {6.4}Extended Splash-2 Comparison}{98}{section.6.4}
\contentsline {section}{\numberline {6.5}Effects of Cache Size on Performance}{102}{section.6.5}
\contentsline {section}{\numberline {6.6}Evaluating FreeBSD Commands}{104}{section.6.6}
\contentsline {subsection}{\numberline {6.6.1}DD}{105}{subsection.6.6.1}
\contentsline {subsection}{\numberline {6.6.2}CP}{107}{subsection.6.6.2}
\contentsline {subsection}{\numberline {6.6.3}GREP}{109}{subsection.6.6.3}
\contentsline {subsection}{\numberline {6.6.4}MD5}{110}{subsection.6.6.4}
\contentsline {subsection}{\numberline {6.6.5}SHA-256}{111}{subsection.6.6.5}
\contentsline {section}{\numberline {6.7}Communication Energy Estimation}{112}{section.6.7}
\contentsline {subsection}{\numberline {6.7.1}Parallel Execution}{112}{subsection.6.7.1}
\contentsline {paragraph}{Directory-based coherence}{112}{subsection.6.7.1}
\contentsline {paragraph}{Time-based coherence}{113}{subsection.6.7.1}
\contentsline {subsection}{\numberline {6.7.2}Independent Concurrent Execution}{113}{subsection.6.7.2}
\contentsline {section}{\numberline {6.8}Simplicity}{113}{section.6.8}
\contentsline {section}{\numberline {6.9}Scalability Estimation}{113}{section.6.9}
\contentsline {paragraph}{Directory-based coherence}{113}{section.6.9}
\contentsline {paragraph}{Time-based coherence}{114}{section.6.9}
\contentsline {section}{\numberline {6.10}Conclusion}{115}{section.6.10}
\contentsline {chapter}{\numberline {7}Cache Side-Channel Attacks}{117}{chapter.7}
\contentsline {section}{\numberline {7.1}Effects of Coherence on SCAs}{117}{section.7.1}
\contentsline {section}{\numberline {7.2}SCAs on CHERI}{118}{section.7.2}
\contentsline {subsection}{\numberline {7.2.1}Cryptography and SCAs}{118}{subsection.7.2.1}
\contentsline {subsection}{\numberline {7.2.2}State of the art SCA Mitigation}{119}{subsection.7.2.2}
\contentsline {subsection}{\numberline {7.2.3}Exploiting Time-Based Coherence for SCA Mitigation}{119}{subsection.7.2.3}
\contentsline {section}{\numberline {7.3}BERI SCA Analysis}{120}{section.7.3}
\contentsline {subsection}{\numberline {7.3.1}Memory Footprint Analysis}{120}{subsection.7.3.1}
\contentsline {subsection}{\numberline {7.3.2}Effects of Coherence on SCAs}{122}{subsection.7.3.2}
\contentsline {subsubsection}{\numberline {7.3.2.1}Directory Coherence -- SCA}{122}{subsubsection.7.3.2.1}
\contentsline {subsubsection}{\numberline {7.3.2.2}Time-Based Coherence -- SCA}{122}{subsubsection.7.3.2.2}
\contentsline {section}{\numberline {7.4}Experimental Set-Up}{124}{section.7.4}
\contentsline {section}{\numberline {7.5}Bare Metal Testing}{125}{section.7.5}
\contentsline {subsection}{\numberline {7.5.1}Collocated Tests}{125}{subsection.7.5.1}
\contentsline {subsubsection}{\numberline {7.5.1.1}Results}{126}{subsubsection.7.5.1.1}
\contentsline {paragraph}{Expected Behaviour}{126}{Item.45}
\contentsline {paragraph}{Observed Behaviour - Single-Core}{127}{Item.45}
\contentsline {paragraph}{Observed Behaviour - Directory}{127}{Item.45}
\contentsline {paragraph}{Observed Behaviour - Time-Based}{127}{Item.45}
\contentsline {subsubsection}{\numberline {7.5.1.2}Evaluation}{128}{subsubsection.7.5.1.2}
\contentsline {paragraph}{Figure \ref {baremetal_core_pin_std_1} --}{128}{subsubsection.7.5.1.2}
\contentsline {paragraph}{Figure \ref {baremetal_core_pin_std_2x} --}{129}{subsubsection.7.5.1.2}
\contentsline {paragraph}{Figure \ref {baremetal_core_pin_long_1} --}{133}{figure.caption.60}
\contentsline {paragraph}{Figure \ref {baremetal_core_pin_long_2x} --}{134}{figure.caption.60}
\contentsline {paragraph}{Figure \ref {baremetal_core_pin_reverse} --}{137}{figure.caption.62}
\contentsline {subsection}{\numberline {7.5.2}Distributed Tests}{139}{subsection.7.5.2}
\contentsline {subsubsection}{\numberline {7.5.2.1}Results and Evaluation}{139}{subsubsection.7.5.2.1}
\contentsline {paragraph}{Expected Behaviour}{139}{subsubsection.7.5.2.1}
\contentsline {paragraph}{Observed Behaviour - Directory}{139}{subsubsection.7.5.2.1}
\contentsline {paragraph}{Observed Behaviour - Time-Based}{140}{subsubsection.7.5.2.1}
\contentsline {section}{\numberline {7.6}SCA Testing including an OS}{141}{section.7.6}
\contentsline {paragraph}{Figure \ref {freebsd_sca_corepin_1} --}{142}{section.7.6}
\contentsline {paragraph}{Figure \ref {freebsd_sca_corepin_2} --}{143}{section.7.6}
\contentsline {section}{\numberline {7.7}Protection Level of Time-Based Coherence}{146}{section.7.7}
\contentsline {subsection}{\numberline {7.7.1}Protecting LLC}{147}{subsection.7.7.1}
\contentsline {section}{\numberline {7.8}Further Research}{148}{section.7.8}
\contentsline {section}{\numberline {7.9}Conclusion}{148}{section.7.9}
\contentsline {chapter}{\numberline {8}Conclusions and Future Research}{150}{chapter.8}
\contentsline {section}{\numberline {8.1}Field Contributions}{150}{section.8.1}
\contentsline {section}{\numberline {8.2}Engineering Contributions}{151}{section.8.2}
\contentsline {section}{\numberline {8.3}Further Research}{152}{section.8.3}
\contentsline {subsection}{\numberline {8.3.1}Capability Enhancement of Time-Based Coherence}{152}{subsection.8.3.1}
\contentsline {paragraph}{Discussion}{153}{subsection.8.3.1}
\contentsline {subsection}{\numberline {8.3.2}Scalability}{154}{subsection.8.3.2}
\contentsline {subsection}{\numberline {8.3.3}Cache Configurations}{154}{subsection.8.3.3}
\contentsline {section}{\numberline {8.4}SCA Research Directions}{154}{section.8.4}
\contentsline {chapter}{References}{155}{section.8.4}
